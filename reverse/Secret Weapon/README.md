# Secret Weapon | Medium | Reverse + Steg

## Информация

Контакт с ящерами установлен, теперь их надо победить новым оружием - суперсекретной разработкой НИИ Русь-матушка, написанной на В✞✞. Но есть одна проблема - ящеры повредили ключ доступа к этом оружию и оставили послание. Помоги восстановить этот ключ доступа и победить ящеров.

## Выдать участинкам

secret_weapon, Key, послание.jpeg

## Описание

Дан код на с++, который принимает на вход шестандациричную строку, которая является кодом на js для v8. с++ исполняет этот код и сравнивает с эталонной строкой. Код на js применяет шифр Цезаря с неизвестным сдвигом, который можно узнать из файла "Послание ящеров". 

## Решение

Для начала стоит посмотреть на файл Key. В нём 16-ричная строка. Если её превратить в строку через любой онлайн-редактор, то получится js-код для v8. В нём можно увидеть функцию function process(str), которая применяет к строке шифр Цезаря с пока что неизвестным сдвигом. Сдвиг находится в послание.jpeg в метаданных в поле usercommets (Shift = 6). Записываем этот сдвиг в js-код. Также в js-коде надо вызвать эту функцию, чтобы она что-то вернула. Трансформируем строку в 16-ричный формат и запускаем secret_weapon так: ./secret_weapon [16-ричная строка]. Будет написано: Result: [какое-то число].Теперь закидываем secret_weapon в Ida или Ghidra, ищем строку Result: и переходим в функцию с ней. Если внимательно разревёрсить функцию, то будет понятно, что бинарь принимает нашу строку, трансформирует из 16-ричной строки в строку и выполняет через v8 js-код. Потом результат выполнения он сравнивает с эталонной строкой. Если они равны, то строка из js-кода - верный флаг. Берём эталонную строку из бинаря, делаем обратный сдвиг на 6 символов и получаем флаг, который надо вставить в ctf{}. получается ctf{DoYouLikeJavascriptEnginesNow}

## Флаг

ctf{DoYouLikeJavascriptEnginesNow}
