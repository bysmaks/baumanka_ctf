from Crypto.Util.number import *
NBITS = 1337

g = 2602177424066452484237460728977656201220079742734346937008121911853095785774409011881362199150426533022937284104992135031941248638935195012147222314243913285386623440800480812936022170728616731705474257448474755687465521605729340117510826418728532468176653331277079849122686533745132668857830453761375195123265733694917891861012848569254371870383667888307101457694712467667605444070952949441917019847068482141648620442892294129343941329697640361049845386896658169863003059520372132156183725913779721291750341991136174107939269981658521983419632528333569646324245047973301897932640643546715648975774620911334608509686596865061533460173231291013473780061267332204093115420456764258623514156285742625060783192786467677601321215746512245032687671403638212957321917752166494695212390283366926610511952401196727960202176147401719116713987281142834790316834054296778485853842008972533316626352819334316424181011502936317231762464575955057834989481318103937531117873162785788863747153776583828567733002822007715284935324745127932728861199129682302900018056405530883490118905070277424446645028640340663056612098134844691944768938776043121442572892061404756672619809390001715768590154467893194485273672584820060526528
n = 5471363498348900119164488919760455154513848732697567553320375976456790490506814540953717168213462509102423201299259069730494047123481127345053918684842074183834633886139101157466989269445502098193727666380160482679642692905213000581064904873728908669146352807212496983982953024935527038039143352484100226632278338795813302882732211203604568980681962774165735742267089258091563427586999024555992852669220121155123417681582749286699611824300411754942881718242426241445609035883015161165879536308147636761603632556740655772567604511862909117612048893093090342422974616283426702942341992001442850017912371207400853213934099622152970329255059506213869157721137719300512958895529853533349093328672429483762005277718541667541461199717526055811582556130028215459022330048015549460985566049905417649383719747669514955493460109094236697708388721274763706088507768125735019203607081201264685981572084608866770213525314931809123925213726936705309114273460878951176676262215884066866409755368707201040480870915970783627115501485448274473156087929895336167153694823370128888618144454117202986489560688380677276195952632140347975644260068525662738368814286580182796768354399079385601108749439324585793206414027975802160021
m = 1808971339772241580902799969641349502657898147619888030433320072595818281166784721916618012107104367855415525458077526756875791385368826456995339384149948500495144539891299114191550728956715187068849079286536901396435776437800674759862893844580717706683387682295269642231854109341000144815570853926341391931114306763897111097086060881874752977208351052212994988806656729287766510059991245196669546549547895227285909370321676508803011632384613833355054882803884816066841204083517849560815830677050321663720100149732185870517342094884543776055473486517453330715754791245517219313130676134162268498626861159188366811243822705420223438207123170386457359489202110723189654052793471220819517493031918864177287900156346166501252657579949878119060557456564258740065252931585120883887014059244864135659195813635577419240000895107548621688397399070973009315146088480192015468438741177615841786427234960117318886365065634434454743147810618004543484066761194420569436662015570677494877493036552462873472692520887491155468548450139028214283686429088872448332222911819956471473182118466027042091441005753683866689788346649097003477313122344132381714768542219242345378659834828759654513167606419018695414043240326343466041


def factor(n):
    for i in range(1, 2000 + 1):
        R.<x> = PolynomialRing(ZZ)
        f = x ^ 3 + x ^ 2 * 2 * i - n
        roots = f.roots()
        if len(roots) != 0:
            p = roots[0][0]
            return p, p + 2 * i


if __name__ == "__main__":
    p, q = factor(n)
    assert(n == p ^ 2 * q)
    a = int(pow(m, p-1, p ^ 2) - 1) // p
    b = int(pow(g, p-1, p ^ 2) - 1) // p
    flag = a * inverse(b, p) % p
    print(long_to_bytes(flag))
