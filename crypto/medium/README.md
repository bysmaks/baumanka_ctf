# heheheXD | medium | crypto

### Сложность
medium

### Информация
Очередная задачка на дискретный логарифм. Решите?

### Выдасть участникам
Все, что в папке public: файл task.py и output

### Решение
Перед нами немного упрощенная крипосистема Okamoto–Uchiyama.
[Ссылка на описание криптосистемы](https://en.wikipedia.org/wiki/Okamoto%E2%80%93Uchiyama_cryptosystem)
Главная уязвимость - плохой алгоритм генерации ключей. Можно попробовать ее протестировать и заметить, что количество шагов $k$, которые делает функция для нахождения числа $q$, не превышает 2000. Тогда можно написать, что $N = p^2 \cdot q = p^2 \cdot (p + 2 \cdot k), k \leq 2000$. Раскрывая скобки, можно сказать , что $f(p) = p^3 + 2 \cdot k \cdot p^2 - N$ - многочлен от переменной $p$ с параметром $k$, который можно перебрать. Для каждого $k$ можно найти корни получившегося многочлена, тем самым найдя $p$. После этого спокойно имплементируем алгоритм расшифрования из статьи и получаем флаг.

```
sage sploit.sage
```

### Флаг
ctf{another_boring_factorisation}
